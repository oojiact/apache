CIS security Apache

1.2.2 Enable the Log Config Module (Scored)

edit httpd.conf

LoadModule log_config_module modules/mod_log_config.so

<IfModule log_config_module>
    #
    # The following directives define some format nicknames for use with
    # a CustomLog directive (see below).
    #
    #LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
	LogFormat "%{NS-Client-IP}i %h %l %u %t \"%r\" %>s TIME: %D %b \"%{Referer}i\" \"%{User-Agent}i\""
    LogFormat "%h %l %u %t \"%r\" %>s %b" common

    <IfModule logio_module>
      # You need to enable mod_logio.c to use %I and %O
      #LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
	  LogFormat "%{NS-Client-IP}i %h %l %u %t \"%r\" %>s TIME: %D %b \"%{Referer}i\" \"%{User-Agent}i\""
    </IfModule>

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a <VirtualHost>
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-<VirtualHost> access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    #CustomLog "logs/access_log" common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    CustomLog "logs/access_log" combined
</IfModule>


1.2.3	Disable	WebDAV	Modules	(Scored)
# httpd -M | grep ' dav_[[:print:]]+module' 
##LoadModule dav_module modules/mod_dav.so

1.2.4	Disable	Status	Module	(Scored)
# httpd -M | egrep 'status_module' 

##LoadModule status_module modules/mod_status.so 


1.2.5	Disable	Autoindex	Module	(Scored)

# httpd -M | grep autoindex_module 

## LoadModule autoindex_module modules/mod_autoindex.so

1.2.6	Disable	Proxy	Modules	(Scored)

# httpd -M | grep proxy_ 

##LoadModule proxy_module modules/mod_proxy.so
##LoadModule proxy_connect_module modules/mod_proxy_connect.so
##LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
##LoadModule proxy_http_module modules/mod_proxy_http.so
##LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
##LoadModule proxy_scgi_module modules/mod_proxy_scgi.so
##LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
##LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
##LoadModule proxy_express_module modules/mod_proxy_express.so


1.2.7	Disable	User	Directories	Modules	(Scored)
# httpd -M | grep userdir_ 


##LoadModule userdir_module modules/mod_userdir.so 

1.2.8	Disable	Info	Module	(Scored)

# httpd -M | egrep 'info_module' 

##LoadModule info_module modules/mod_info.so

1.3.1	Run	the	Apache	Web	Server	as	a	non-root	user	(Scored)

# grep -i '^User' $APACHE_PREFIX/conf/httpd.conf
User apache
# grep -i '^Group' $APACHE_PREFIX/conf/httpd.conf
Group apache 



##LoadModule dav_fs_module modules/mod_dav_fs.so 

1.2.4	Disable	Status	Module	(Scored)
# httpd -M | egrep 'status_module' 

##LoadModule status_module modules/mod_status.so 


1.2.5	Disable	Autoindex	Module	(Scored)

# httpd -M | grep autoindex_module 

## LoadModule autoindex_module modules/mod_autoindex.so

1.2.6	Disable	Proxy	Modules	(Scored)

# httpd -M | grep proxy_ 

##LoadModule proxy_module modules/mod_proxy.so
##LoadModule proxy_connect_module modules/mod_proxy_connect.so
##LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
##LoadModule proxy_http_module modules/mod_proxy_http.so
##LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
##LoadModule proxy_scgi_module modules/mod_proxy_scgi.so
##LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
##LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
##LoadModule proxy_express_module modules/mod_proxy_express.so


1.2.7	Disable	User	Directories	Modules	(Scored)
# httpd -M | grep userdir_ 


##LoadModule userdir_module modules/mod_userdir.so 

1.2.8	Disable	Info	Module	(Scored)

# httpd -M | egrep 'info_module' 

##LoadModule info_module modules/mod_info.so

1.3.1	Run	the	Apache	Web	Server	as	a	non-root	user	(Scored)

# grep -i '^User' $APACHE_PREFIX/conf/httpd.conf
User apache
# grep -i '^Group' $APACHE_PREFIX/conf/httpd.conf
Group apache 


# grep '^UID_MIN' /etc/login.defs
# id apache 


# groupadd -r apache
# useradd apache -r -g apache -d /var/www -s /sbin/nologin 

edit httpd.conf

User apache
Group apache 


